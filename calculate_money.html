<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡∏ó W041-001 (Final Compact)</title>
    <style>
        /* CSS ‡∏´‡∏•‡∏±‡∏Å (‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£) */
        body { font-family: Tahoma, sans-serif; margin: 0; padding: 10px; background: #f0f2f5; font-size: 13px; color: #333; }
        
        .form-container {
            width: 98%; 
            max-width: 800px;
            margin: 10px auto;
            padding: 15px 10px;
            background: white;
            border: 2px solid #333;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            overflow-x: auto; 
        }

        /* Main table styles */
        table { 
            width: 100%; 
            border-collapse: collapse; 
            margin-bottom: 10px; 
            min-width: 750px;
        }
        th, td { 
            border: 1px solid #000;
            padding: 2px 1px;
            text-align: center; 
            vertical-align: top;
            font-size: 0.75em; 
            line-height: 1.1;
        }
        th { background: #e0e0e0; font-weight: bold; height: 30px;}
        td.label { text-align: left; font-weight: bold; font-size: 0.85em; padding-left: 3px; }

        /* Input/Calculated Field Styles */
        input[type="number"], input[type="text"] { 
            width: 100%; 
            padding: 2px 0; 
            text-align: right; 
            border: none; 
            box-sizing: border-box; 
            font-size: 0.9em; 
            background: none; 
        }
        input[type="number"].data-input-field { background: #fffacd; }
        
        .calculated-field { background: #f0f8ff; font-weight: bold; text-align: right; font-size: 0.9em;}
        .money-field { background: #e6ffe6; font-weight: bold; text-align: right; font-size: 0.9em;}
        
        .sub-total-row td { background: #e7e7e7; font-weight: bold; padding: 5px 1px; }
        .grand-total-row td { background: #d4edda; font-weight: bold; font-size: 1em; }
        
        /* Summary Section (‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á) */
        .summary-grid { display: flex; flex-wrap: wrap; justify-content: space-between; margin-top: 10px; }
        .summary-box { border: 1px solid #000; padding: 5px; margin-bottom: 10px; font-size: 0.85em;}

        .summary-left { flex-basis: 49%; }
        .summary-right { flex-basis: 49%; }

        .summary-row-item { display: flex; justify-content: space-between; margin-bottom: 3px; align-items: center;}
        .summary-row-item label { font-weight: bold; flex-basis: 60%; text-align: left; } 
        .summary-row-item .data-input-box, .summary-row-item .calculated-output { flex-basis: 40%; text-align: right; }
        
        .summary-box input { width: 100%; text-align: right; border: 1px solid #ccc; padding: 2px; box-sizing: border-box; background: #fffacd; }
        .summary-box .calculated-output, .summary-box .money-field-output { border: 1px solid #000; padding: 2px; font-weight: bold; }
        .summary-box .calculated-output { background: #f0f8ff; }
        .summary-box .money-field-output { background: #e6ffe6; }
        
        /* Cash Denomination Table (Compact) */
        .cash-table-container { width: 100%; } 
        .cash-table { width: 100%; margin-top: 5px; }
        .cash-table th, .cash-table td { font-size: 0.8em; padding: 3px 1px; }
        .cash-table input { width: 95%; background: #fffacd; }
        .cash-total-row td { background: #d4edda; font-weight: bold; }

        /* Style for cash counter at the bottom */
        .cash-counter-summary {
            margin-top: 10px;
            padding: 10px;
            border: 2px solid #007bff;
            border-radius: 5px;
            background: #e6f7ff;
        }
        .cash-counter-summary .summary-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px 0;
            font-weight: bold;
        }
    </style>
</head>
<body>

<div class="form-container">
    
    <table>
        <thead>
            <tr>
                <th rowspan="3" style="width: 15%;">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
                <th colspan="6">‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
                <th rowspan="3" style="width: 5%;">‡∏£‡∏ß‡∏°‡πÄ‡∏ö‡∏¥‡∏Å</th>
                <th rowspan="3" style="width: 5%;">‡∏Ñ‡∏∑‡∏ô</th>
                <th rowspan="3" style="width: 5%;">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠<br/>‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</th>
                <th rowspan="3" style="width: 5%;">‡πÅ‡∏ñ‡∏°<br/>‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</th>
                <th colspan="3" style="width: 30%;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ</th>
            </tr>
            <tr>
                <th style="width: 5%;">1</th>
                <th style="width: 5%;">2</th>
                <th style="width: 5%;">3</th>
                <th style="width: 5%;">4</th>
                <th style="width: 5%;">5</th>
                <th style="width: 5%;">6</th>
                <th style="width: 5%;">‡∏£‡∏≤‡∏Ñ‡∏≤/<br/>‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                <th style="width: 5%;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                <th style="width: 10%;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</th>
            </tr>
            <tr>
                <th>‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
                <th>‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
                <th>‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
                <th>‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
                <th>‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
                <th>‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
                <td colspan="3"></td>
            </tr>
        </thead>
        <tbody>
            
            <tr>
                <td class="label" rowspan="8">‡∏´‡∏•‡∏≠‡∏î‡πÉ‡∏´‡∏ç‡πà</td>
                <td class="data-input"><input type="number" id="stk_1_hl" value="65" oninput="calculate()" class="data-input-field" inputmode="numeric"></td>
                <td class="data-input"><input type="number" id="stk_2_hl" value="25" oninput="calculate()" class="data-input-field" inputmode="numeric"></td>
                <td class="data-input"><input type="number" id="stk_3_hl" value="15" oninput="calculate()" class="data-input-field" inputmode="numeric"></td>
                <td class="data-input"><input type="number" id="stk_4_hl" value="0" oninput="calculate()" class="data-input-field" inputmode="numeric"></td>
                <td class="data-input"><input type="number" id="stk_5_hl" value="0" oninput="calculate()" class="data-input-field" inputmode="numeric"></td>
                <td class="data-input"><input type="number" id="stk_6_hl" value="0" oninput="calculate()" class="data-input-field" inputmode="numeric"></td>
                <td class="calculated-field" id="total_in_hl">105</td>
                <td class="data-input"><input type="number" id="returned_hl" value="13" oninput="calculate()" class="data-input-field" inputmode="numeric"></td>
                <td class="calculated-field" id="net_remaining_hl">92</td>
                <td class="data-input"><input type="number" id="free_qty_hl" value="1" oninput="calculate()" class="data-input-field" inputmode="numeric"></td>
                
                <td>**27**</td><td class="data-input"><input type="number" id="qty_27_hl" value="0" oninput="calculate()" class="data-input-field" inputmode="numeric"></td><td class="money-field" id="money_27_hl">0.00</td>
            </tr>
            <tr>
                <td colspan="10"></td>
                <td>**28**</td><td class="data-input"><input type="number" id="qty_28_hl" value="0" oninput="calculate()" class="data-input-field" inputmode="numeric"></td><td class="money-field" id="money_28_hl">0.00</td>
            </tr>
            <tr>
                <td colspan="10"></td>
                <td>30</td><td class="data-input"><input type="number" id="qty_30_hl" value="9" oninput="calculate()" class="data-input-field" inputmode="numeric"></td><td class="money-field" id="money_30_hl">270.00</td>
            </tr>
            <tr>
                <td colspan="10"></td>
                <td>32</td><td class="data-input"><input type="number" id="qty_32_hl" value="3" oninput="calculate()" class="data-input-field" inputmode="numeric"></td><td class="money-field" id="money_32_hl">96.00</td>
            </tr>
            <tr>
                <td colspan="10"></td>
                <td>35</td><td class="data-input"><input type="number" id="qty_35_hl" value="5" oninput="calculate()" class="data-input-field" inputmode="numeric"></td><td class="money-field" id="money_35_hl">175.00</td>
            </tr>
            <tr>
                <td colspan="10"></td>
                <td>38</td><td class="data-input"><input type="number" id="qty_38_hl" value="0" oninput="calculate()" class="data-input-field" inputmode="numeric"></td><td class="money-field" id="money_38_hl">0.00</td>
            </tr>
             <tr>
                <td colspan="10"></td>
                <td>100/3</td><td class="data-input"><input type="number" id="qty_100_hl" value="20" oninput="calculate()" class="data-input-field" inputmode="numeric"></td><td class="money-field" id="money_100_hl">666.67</td>
            </tr>
            <tr>
                <td colspan="10" class="sub-total-row" style="text-align: right; padding-right: 5px;">‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô ‡∏´‡∏•‡∏≠‡∏î‡πÉ‡∏´‡∏ç‡πà</td>
                <td colspan="2"></td>
                <td class="money-field" id="sub_total_money_hl">1207.67</td>
            </tr>

            <tr>
                <td class="label" rowspan="8">‡∏ö‡∏î‡∏´‡∏¢‡∏≤‡∏ö</td>
                <td class="data-input"><input type="number" id="stk_1_bh" value="39" oninput="calculate()" class="data-input-field" inputmode="numeric"></td>
                <td class="data-input"><input type="number" id="stk_2_bh" value="12" oninput="calculate()" class="data-input-field" inputmode="numeric"></td>
                <td class="data-input"><input type="number" id="stk_3_bh" value="10" oninput="calculate()" class="data-input-field" inputmode="numeric"></td>
                <td class="data-input"><input type="number" id="stk_4_bh" value="0" oninput="calculate()" class="data-input-field" inputmode="numeric"></td>
                <td class="data-input"><input type="number" id="stk_5_bh" value="0" oninput="calculate()" class="data-input-field" inputmode="numeric"></td>
                <td class="data-input"><input type="number" id="stk_6_bh" value="0" oninput="calculate()" class="data-input-field" inputmode="numeric"></td>
                <td class="calculated-field" id="total_in_bh">61</td>
                <td class="data-input"><input type="number" id="returned_bh" value="0" oninput="calculate()" class="data-input-field" inputmode="numeric"></td>
                <td class="calculated-field" id="net_remaining_bh">61</td>
                <td class="data-input"><input type="number" id="free_qty_bh" value="0" oninput="calculate()" class="data-input-field" inputmode="numeric"></td>
                
                <td>**27**</td><td class="data-input"><input type="number" id="qty_27_bh" value="0" oninput="calculate()" class="data-input-field" inputmode="numeric"></td><td class="money-field" id="money_27_bh">0.00</td>
            </tr>
            <tr>
                <td colspan="10"></td>
                <td>**28**</td><td class="data-input"><input type="number" id="qty_28_bh" value="0" oninput="calculate()" class="data-input-field" inputmode="numeric"></td><td class="money-field" id="money_28_bh">0.00</td>
            </tr>
            <tr>
                <td colspan="10"></td>
                <td>40</td><td class="data-input"><input type="number" id="qty_40_bh" value="13" oninput="calculate()" class="data-input-field" inputmode="numeric"></td><td class="money-field" id="money_40_bh">520.00</td>
            </tr>
            <tr>
                <td colspan="10"></td>
                <td>41</td><td class="data-input"><input type="number" id="qty_41_bh" value="6" oninput="calculate()" class="data-input-field" inputmode="numeric"></td><td class="money-field" id="money_41_bh">246.00</td>
            </tr>
            <tr>
                <td colspan="10"></td>
                <td>43</td><td class="data-input"><input type="number" id="qty_43_bh" value="28" oninput="calculate()" class="data-input-field" inputmode="numeric"></td><td class="money-field" id="money_43_bh">1204.00</td>
            </tr>
            <tr>
                <td colspan="10"></td>
                <td>45</td><td class="data-input"><input type="number" id="qty_45_bh" value="0" oninput="calculate()" class="data-input-field" inputmode="numeric"></td><td class="money-field" id="money_45_bh">0.00</td>
            </tr>
            <tr>
                <td colspan="10"></td>
                <td>-</td><td class="data-input"><input type="number" id="qty_custom_bh" value="0" oninput="calculate()" class="data-input-field" inputmode="numeric"></td><td class="money-field" id="money_custom_bh">0.00</td>
            </tr>
            <tr>
                <td colspan="10" class="sub-total-row" style="text-align: right; padding-right: 5px;">‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô ‡∏ö‡∏î‡∏´‡∏¢‡∏≤‡∏ö</td>
                <td colspan="2"></td>
                <td class="money-field" id="sub_total_money_bh">1970.00</td>
            </tr>
            
            <tr>
                <td class="label" rowspan="6">‡∏ö‡∏î‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</td>
                <td class="data-input"><input type="number" id="stk_1_bl" value="1" oninput="calculate()" class="data-input-field" inputmode="numeric"></td>
                <td class="data-input" colspan="5"><input type="number" value="0" oninput="calculate()" class="data-input-field" inputmode="numeric" style="text-align: center;"></td>
                <td class="calculated-field" id="total_in_bl">1</td>
                <td class="data-input"><input type="number" id="returned_bl" value="0" oninput="calculate()" class="data-input-field" inputmode="numeric"></td>
                <td class="calculated-field" id="net_remaining_bl">1</td>
                <td class="data-input"><input type="number" id="free_qty_bl" value="0" oninput="calculate()" class="data-input-field" inputmode="numeric"></td>
                
                <td>**27**</td><td class="data-input"><input type="number" id="qty_27_bl" value="0" oninput="calculate()" class="data-input-field" inputmode="numeric"></td><td class="money-field" id="money_27_bl">0.00</td>
            </tr>
            <tr>
                <td colspan="10"></td>
                <td>**28**</td><td class="data-input"><input type="number" id="qty_28_bl" value="0" oninput="calculate()" class="data-input-field" inputmode="numeric"></td><td class="money-field" id="money_28_bl">0.00</td>
            </tr>
            <tr>
                <td colspan="10"></td>
                <td>35</td><td class="data-input"><input type="number" id="qty_35_bl" value="1" oninput="calculate()" class="data-input-field" inputmode="numeric"></td><td class="money-field" id="money_35_bl">35.00</td>
            </tr>
            <tr>
                <td colspan="10"></td>
                <td>40</td><td class="data-input"><input type="number" id="qty_40_bl" value="0" oninput="calculate()" class="data-input-field" inputmode="numeric"></td><td class="money-field" id="money_40_bl">0.00</td>
            </tr>
            <tr>
                <td colspan="10"></td>
                <td>-</td><td class="data-input"><input type="number" id="qty_custom_bl" value="0" oninput="calculate()" class="data-input-field" inputmode="numeric"></td><td class="money-field" id="money_custom_bl">0.00</td>
            </tr>
            <tr>
                <td colspan="10" class="sub-total-row" style="text-align: right; padding-right: 5px;">‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô ‡∏ö‡∏î‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</td>
                <td colspan="2"></td>
                <td class="money-field" id="sub_total_money_bl">35.00</td>
            </tr>

            <tr class="grand-total-row">
                <td colspan="7" class="label" style="text-align: right; padding-right: 5px;">‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô</td>
                <td class="calculated-field" id="grand_total_in">167</td>
                <td class="calculated-field" id="total_returned">13</td>
                <td class="calculated-field" id="grand_net_remaining">154</td>
                <td class="calculated-field" id="total_free">1</td>
                <td colspan="2" class="label" style="text-align: right; padding-right: 5px;">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏Ç‡∏≤‡∏¢</td>
                <td class="money-field" id="grand_total_sales">3212.67</td>
            </tr>
        </tbody>
    </table>

    
    <div class="summary-grid">
        <div class="summary-box summary-left">
            <h4 style="margin: 0 0 5px 0; border-bottom: 1px dotted #ccc;">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏´‡∏±‡∏Å‡∏•‡∏ö</h4>
            <div class="summary-row-item">
                <label>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∏‡∏° (Total Sales)</label>
                <div class="money-field-output" id="summary_grand_total_sales">3212.67</div>
            </div>
            <div class="summary-row-item">
                <label>‡∏´‡∏±‡∏Å ‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï</label>
                <div class="data-input-box"><input type="number" id="debt_in" value="40" oninput="calculate()" class="data-input-field" inputmode="numeric"></div>
            </div>
            <div class="summary-row-item">
                <label>‡∏Ñ‡πâ‡∏≤‡∏á‡∏£‡∏±‡∏ö</label>
                <div class="data-input-box"><input type="number" id="debt_out_cash" value="60" oninput="calculate()" class="data-input-field" inputmode="numeric"></div>
            </div>
            <div class="summary-row-item">
                <label style="font-size: 1.1em;">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡πÄ‡∏á‡∏¥‡∏ô</label>
                <div class="money-field-output" id="total_after_debt" style="font-size: 1.1em; background: #ffe6f2;">3112.67</div>
            </div>
            <div class="summary-row-item">
                <label>‡∏´‡∏±‡∏Å ‡πÄ‡∏á‡∏¥‡∏ô‡πÇ‡∏≠‡∏ô (‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ)</label>
                <div class="data-input-box"><input type="number" id="transfer_money" value="2880" oninput="calculate()" class="data-input-field" inputmode="numeric"></div>
            </div>
            <div class="summary-row-item">
                <label style="font-size: 1.1em;">‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ (Net Cash Due)</label>
                <div class="money-field-output" id="net_cash_due" style="background: #b8daff; font-size: 1.1em;">232.67</div>
            </div>
        </div>
        
        <div class="summary-box summary-right">
            <div class="cash-table-container">
                <h4 style="margin: 0 0 5px 0; border-bottom: 1px dotted #ccc;">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡∏™‡πà‡∏á‡πÄ‡∏á‡∏¥‡∏ô (‡∏ô‡∏±‡∏ö‡∏™‡∏î)</h4>
                <table class="cash-table">
                    <thead>
                        <tr>
                            <th style="width: 20%;">‡∏ä‡∏ô‡∏¥‡∏î</th>
                            <th style="width: 40%;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                            <th style="width: 40%;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr data-value="1000"><td>1,000</td><td class="data-input"><input type="number" id="cash_qty_1000" value="3" oninput="calculateCash()" class="data-input-field" inputmode="numeric"></td><td class="calculated-field" id="cash_total_1000">3,000.00</td></tr>
                        <tr data-value="500"><td>500</td><td class="data-input"><input type="number" id="cash_qty_500" value="0" oninput="calculateCash()" class="data-input-field" inputmode="numeric"></td><td class="calculated-field" id="cash_total_500">0.00</td></tr>
                        <tr data-value="100"><td>100</td><td class="data-input"><input type="number" id="cash_qty_100" value="11" oninput="calculateCash()" class="data-input-field" inputmode="numeric"></td><td class="calculated-field" id="cash_total_100">1,100.00</td></tr>
                        <tr data-value="50"><td>50</td><td class="data-input"><input type="number" id="cash_qty_50" value="2" oninput="calculateCash()" class="data-input-field" inputmode="numeric"></td><td class="calculated-field" id="cash_total_50">100.00</td></tr>
                        <tr data-value="20"><td>20</td><td class="data-input"><input type="number" id="cash_qty_20" value="47" oninput="calculateCash()" class="data-input-field" inputmode="numeric"></td><td class="calculated-field" id="cash_total_20">940.00</td></tr>
                        <tr data-value="10"><td>10</td><td class="data-input"><input type="number" id="cash_qty_10" value="5" oninput="calculateCash()" class="data-input-field" inputmode="numeric"></td><td class="calculated-field" id="cash_total_10">50.00</td></tr>
                        <tr data-value="5"><td>5</td><td class="data-input"><input type="number" id="cash_qty_5" value="16" oninput="calculateCash()" class="data-input-field" inputmode="numeric"></td><td class="calculated-field" id="cash_total_5">80.00</td></tr>
                        <tr data-value="2"><td>2</td><td class="data-input"><input type="number" id="cash_qty_2" value="10" oninput="calculateCash()" class="data-input-field" inputmode="numeric"></td><td class="calculated-field" id="cash_total_2">20.00</td></tr>
                        <tr data-value="1"><td>1</td><td class="data-input"><input type="number" id="cash_qty_1" value="42" oninput="calculateCash()" class="data-input-field" inputmode="numeric"></td><td class="calculated-field" id="cash_total_1">42.00</td></tr>
                        <tr class="cash-total-row"><td colspan="2">‡∏£‡∏ß‡∏°</td><td id="cash_grand_total">5,332.00</td></tr>
                    </tbody>
                </table>
                
                <span id="actual_cash_counted" style="display: none;">5332.00</span>
                
                <div class="cash-counter-summary">
                    <div class="summary-row">
                        <label for="truck_select">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏£‡∏ñ</label>
                        <select id="truck_select" style="width: 50%; text-align: right; height: 30px; padding: 2px;">
                            <option value="‡∏£‡∏ñ 1">‡∏£‡∏ñ 1</option>
                            <option value="‡∏£‡∏ñ 2">‡∏£‡∏ñ 2</option>
                        </select>
                    </div>
                     <div class="summary-row">
                        <label>‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏±‡∏ö‡πÑ‡∏î‡πâ</label>
                        <span class="money-field-output" id="display_cash_counted" style="background: #fff3cd; font-size: 1.05em;">5,332.00</span>
                    </div>
                    <div class="summary-row">
                        <label>‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á (‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏ö‡∏ö)</label>
                        <input type="number" id="system_sales_amount" value="5332" oninput="calculateDifference(parseFloat(document.getElementById('actual_cash_counted').textContent) || 0)" class="data-input-field" style="background: white; width: 50%; height: 30px;">
                    </div>
                    <div class="summary-row">
                        <label>‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á (‡πÄ‡∏á‡∏¥‡∏ô‡∏ô‡∏±‡∏ö‡πÑ‡∏î‡πâ - ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢)</label>
                        <span class="money-field-output" id="difference_amount" style="background: #ffe0e0; font-size: 1.05em;">0.00</span>
                    </div>
                     <button onclick="saveAndExport()" style="width: 100%; padding: 8px; background: #28a745; color: white; border: none; border-radius: 4px; margin-top: 10px; font-weight: bold;">
                        ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏•‡πÅ‡∏•‡∏∞‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå üíæ
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    </div>


<script>
    const iceTypes = ['hl', 'bh', 'bl'];
    // FIX: ‡πÄ‡∏û‡∏¥‡πà‡∏° 27 ‡πÅ‡∏•‡∏∞ 28 ‡πÉ‡∏ô Array ‡∏£‡∏≤‡∏Ñ‡∏≤
    const pricesHL = [27, 28, 30, 32, 35, 38, (100 / 3)]; 
    const pricesBH = [27, 28, 40, 41, 43, 45]; 
    const pricesBL = [27, 28, 35, 40];
    const cashDenominations = [1000, 500, 100, 50, 20, 10, 5, 2, 1];

    function formatCurrency(amount) {
        return parseFloat(amount).toLocaleString('th-TH', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    }
    
    function getInputValue(id) {
        const inputElement = document.getElementById(id);
        if (!inputElement || inputElement.value.trim() === '-' || inputElement.value.trim() === '') {
            return 0;
        }
        return parseFloat(inputElement.value) || 0;
    }
    
    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏ó‡∏µ‡πà‡∏ô‡∏±‡∏ö‡πÑ‡∏î‡πâ (‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô)
    function calculateCash() {
        let cashGrandTotal = 0;
        cashDenominations.forEach(value => {
            const qty = getInputValue(`cash_qty_${value}`);
            const rowTotal = qty * value;
            document.getElementById(`cash_total_${value}`).textContent = formatCurrency(rowTotal);
            cashGrandTotal += rowTotal;
        });
        document.getElementById('cash_grand_total').textContent = formatCurrency(cashGrandTotal);
        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ã‡πà‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
        document.getElementById('actual_cash_counted').textContent = cashGrandTotal; 
        document.getElementById('display_cash_counted').textContent = formatCurrency(cashGrandTotal);
        
        // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡∏ô‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à
        const systemSales = getInputValue('system_sales_amount');
        calculateDifference(cashGrandTotal, systemSales);
        return cashGrandTotal;
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á (‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏ô‡∏±‡∏ö‡πÑ‡∏î‡πâ - ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏à‡∏£‡∏¥‡∏á‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏ö‡∏ö)
    function calculateDifference(actualCash) {
        // NOTE: ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡∏ä‡πà‡∏≠‡∏á input "‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á (‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏ö‡∏ö)" ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á
        const systemSales = getInputValue('system_sales_amount');
        const difference = actualCash - systemSales;
        
        const diffElement = document.getElementById('difference_amount');
        diffElement.textContent = formatCurrency(difference);

        // ‡∏™‡∏µ‡∏ï‡∏≤‡∏°‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á
        diffElement.style.backgroundColor = (difference < 0) ? '#ffb3b3' : (difference > 0) ? '#c2f0c2' : '#b8daff';
    }

    /** ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å: ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å */
    function calculate() {
        let grandTotalSales = 0;
        let grandTotalIn = 0; 
        let grandReturned = 0; 
        let grandNetRemaining = 0; 
        let totalFree = 0;

        // --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏ï‡πä‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡∏¢‡∏≠‡∏î‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ ---
        iceTypes.forEach(type => {
            let totalIn = 0;
            for (let i = 1; i <= 6; i++) {
                totalIn += getInputValue(`stk_${i}_${type}`);
            }
            
            let returned = getInputValue(`returned_${type}`);
            let freeQty = getInputValue(`free_qty_${type}`);

            let netRemaining = totalIn - returned; 
            
            document.getElementById(`total_in_${type}`).textContent = Math.round(totalIn);
            document.getElementById(`net_remaining_${type}`).textContent = Math.round(netRemaining);

            grandTotalIn += totalIn;
            grandReturned += returned;
            grandNetRemaining += netRemaining; 
            totalFree += freeQty;

            // D. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô
            let subTotalMoney = 0;
            let currentPrices = [];
            
            if (type === 'hl') currentPrices = pricesHL;
            else if (type === 'bh') currentPrices = pricesBH;
            else if (type === 'bl') currentPrices = pricesBL;

            currentPrices.forEach(priceValue => {
                let idSuffix = (priceValue === (100 / 3)) ? `100_${type}` : `${priceValue}_${type}`;
                
                const qty = getInputValue(`qty_${idSuffix}`);
                const money = qty * priceValue;
                
                const moneyElement = document.getElementById(`money_${idSuffix}`);
                if (moneyElement) {
                    moneyElement.textContent = formatCurrency(money);
                    subTotalMoney += money;
                }
            });
            
            // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏Ñ‡∏≤ Custom
            const moneyCustomElement = document.getElementById(`money_custom_${type}`);
            if (moneyCustomElement) {
                 const moneyCustom = getInputValue(`money_custom_${type}`); 
                 subTotalMoney += moneyCustom;
            }

            document.getElementById(`sub_total_money_${type}`).textContent = formatCurrency(subTotalMoney);
            grandTotalSales += subTotalMoney;
        });

        // --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° (Grand Totals) ---
        document.getElementById('grand_total_in').textContent = Math.round(grandTotalIn);
        document.getElementById('total_returned').textContent = Math.round(grandReturned);
        document.getElementById('grand_net_remaining').textContent = Math.round(grandNetRemaining);
        document.getElementById('total_free').textContent = Math.round(totalFree);
        document.getElementById('grand_total_sales').textContent = formatCurrency(grandTotalSales);
        document.getElementById('summary_grand_total_sales').textContent = formatCurrency(grandTotalSales);


        // --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏¢‡∏≠‡∏î‡∏ô‡∏≥‡∏™‡πà‡∏á‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ ---
        const debtIn = getInputValue('debt_in'); 
        const debtOutCash = getInputValue('debt_out_cash'); 
        const transferMoney = getInputValue('transfer_money'); 

        const totalAfterDebt = grandTotalSales - debtIn - debtOutCash;
        document.getElementById('total_after_debt').textContent = formatCurrency(totalAfterDebt);
        
        const netCashDue = totalAfterDebt - transferMoney;
        document.getElementById('net_cash_due').textContent = formatCurrency(netCashDue);
        
        // --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 4: ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏ó‡∏µ‡πà‡∏ô‡∏±‡∏ö‡πÑ‡∏î‡πâ) ---
        const actualCash = parseFloat(document.getElementById('actual_cash_counted').textContent) || 0;
        calculateDifference(actualCash);
    }
    
    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Export (‡∏ô‡∏≥‡∏°‡∏≤‡∏à‡∏≤‡∏Å cash_counter.html ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πà‡∏° '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏•')
    function saveAndExport() {
        const grandTotalSales = parseFloat(document.getElementById('grand_total_sales').textContent.replace(/,/g, '')) || 0;
        const netCashDue = parseFloat(document.getElementById('net_cash_due').textContent.replace(/,/g, '')) || 0;
        const truckId = document.getElementById('truck_select').value;
        const actualCash = parseFloat(document.getElementById('actual_cash_counted').textContent) || 0;
        const systemSales = getInputValue('system_sales_amount');
        const difference = actualCash - systemSales;
        
        if (grandTotalSales === 0) {
             alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å!');
             return;
        }

        const now = new Date();
        const safeDateTimeStr = now.toLocaleDateString('th-TH') + ' ' + now.toLocaleTimeString('th-TH');
        
        const filename = `${truckId.replace(/ /g, '_')}_RECONCILE_${now.toISOString().slice(0, 10)}.csv`;

        let csvContent = `Truck ID:,${truckId}\n`;
        csvContent += `Date/Time:,${safeDateTimeStr}\n`;
        csvContent += `===================================\n`;
        csvContent += `‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∏‡∏° (Sales):,${formatCurrency(grandTotalSales)}\n`;
        csvContent += `‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ (Net Cash Due):,${formatCurrency(netCashDue)}\n`;
        csvContent += `‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏±‡∏ö‡πÑ‡∏î‡πâ (Actual Cash):,${formatCurrency(actualCash)}\n`;
        csvContent += `‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏ö‡∏ö (System Sales):,${formatCurrency(systemSales)}\n`;
        csvContent += `‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á (Difference):,${formatCurrency(difference)}\n`;
        csvContent += `===================================\n`;
        csvContent += `‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏ï‡πä‡∏≠‡∏Å/‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢:\n`;
        
        // ** ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å (‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ç‡∏¢‡∏≤‡∏¢‡πÑ‡∏î‡πâ) **
        csvContent += `Ice Type,Total In,Returned,Net Remaining,Free,Sub Total Money\n`;
        iceTypes.forEach(type => {
            const totalIn = document.getElementById(`total_in_${type}`).textContent;
            const returned = document.getElementById(`returned_${type}`).value || '-';
            const netRemaining = document.getElementById(`net_remaining_${type}`).textContent;
            const freeQty = document.getElementById(`free_qty_${type}`).value || '-';
            const subTotalMoney = document.getElementById(`sub_total_money_${type}`).textContent;
            
            const typeLabel = (type === 'hl') ? '‡∏´‡∏•‡∏≠‡∏î‡πÉ‡∏´‡∏ç‡πà' : (type === 'bh') ? '‡∏ö‡∏î‡∏´‡∏¢‡∏≤‡∏ö' : '‡∏ö‡∏î‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î';
            csvContent += `${typeLabel},${totalIn},${returned},${netRemaining},${freeQty},${subTotalMoney}\n`;
        });


        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        
        link.setAttribute('href', URL.createObjectURL(blob));
        link.setAttribute('download', filename);

        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
        alert(`‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡πÑ‡∏ü‡∏•‡πå‡∏ñ‡∏π‡∏Å‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏ô‡∏ä‡∏∑‡πà‡∏≠: ${filename}`);
    }

    // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
    document.addEventListener('DOMContentLoaded', () => {
         // ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏ö‡∏ö‡∏ú‡∏™‡∏°
         calculateCash(); // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏ó‡∏µ‡πà‡∏ô‡∏±‡∏ö‡πÑ‡∏î‡πâ‡∏Å‡πà‡∏≠‡∏ô
         calculate(); // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏ã‡∏∂‡πà‡∏á‡∏à‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏Å calculateDifference ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á)
    });
</script>
</body>
</html>
