<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ice Stock Tracker (AjarnG Edition)</title>
    <style>
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡πâ‡∏î‡∏π‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÅ‡∏≠‡∏õ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
        body { 
            font-family: sans-serif; 
            margin: 0; 
            padding: 15px; 
            background: #f4f4f9; 
        }
        h1 { 
            color: #007bff; 
            text-align: center; 
            margin-bottom: 25px;
        }
        .stock-display, .log-area, .transaction-form { 
            margin-bottom: 20px; 
            padding: 15px; 
            background: white; 
            border-radius: 8px; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.1); 
        }
        .stock-item { 
            display: flex; 
            justify-content: space-between; 
            padding: 8px 0; 
            border-bottom: 1px solid #eee; 
            font-size: 1.1em;
        }
        .form-control { 
            margin-bottom: 10px; 
        }
        .form-control label { 
            display: block; 
            font-weight: bold; 
            margin-bottom: 5px; 
        }
        select, input[type="number"] {
            width: 100%;
            padding: 10px;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 16px;
        }
        button { 
            padding: 12px 15px; 
            background: #28a745; 
            color: white; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
            width: 100%; 
            margin-top: 15px; 
            font-size: 18px;
            font-weight: bold;
        }
        .log-list { 
            max-height: 350px; 
            overflow-y: scroll; 
            border: 1px solid #ccc; 
            border-radius: 4px;
            padding: 10px; 
        }
        .log-entry { 
            display: flex; 
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px; 
            border-bottom: 1px dotted #ccc; 
            padding-bottom: 8px; 
            font-size: 0.95em; 
        }
        .log-date-header {
            font-weight: bold;
            background: #e9ecef;
            padding: 5px 10px;
            margin: 5px -10px;
            border-radius: 4px;
            font-size: 1em;
            text-align: center;
            border-top: 1px solid #ccc;
        }
        .delete-btn {
            background: #ff5050; 
            color: white;
            border: none;
            padding: 3px 8px;
            font-size: 0.8em;
            border-radius: 4px;
            cursor: pointer;
            width: auto; 
            margin: 0;
            margin-left: 10px;
        }
    </style>
</head>
<body>

    <h1>‚ùÑÔ∏è Ice Stock Tracker</h1>

    <div class="stock-display" id="current-stock">
        <h2>‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (‡∏Å‡∏£‡∏∞‡∏™‡∏≠‡∏ö)</h2>
    </div>

    <div class="transaction-form" id="adjustment-area">
        <h2>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç/‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏™‡∏ï‡πä‡∏≠‡∏Å (Admin)</h2>
        <div class="form-control">
            <label for="adj-ice-type">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</label>
            <select id="adj-ice-type">
                <option value="‡∏´‡∏•‡∏≠‡∏î">‡∏´‡∏•‡∏≠‡∏î</option><option value="‡∏ö‡∏î‡∏´‡∏¢‡∏≤‡∏ö">‡∏ö‡∏î‡∏´‡∏¢‡∏≤‡∏ö</option><option value="‡∏ö‡∏î‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î">‡∏ö‡∏î‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</option>
            </select>
        </div>
        <div class="form-control">
            <label for="adj-quantity">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°/‡∏•‡∏î (+/-):</label>
            <input type="number" id="adj-quantity" value="1" placeholder="‡πÄ‡∏ä‡πà‡∏ô 50 ‡∏´‡∏£‡∏∑‡∏≠ -10">
        </div>
        <button onclick="adjustStock()" style="background: #ffc107; color: black; margin-top: 5px;">‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏™‡∏ï‡πä‡∏≠‡∏Å</button>
    </div>
    
    <div class="transaction-form">
        <h2>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (‡∏Ç‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô)</h2>
        <div class="form-control">
            <label for="factory-ice-type">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á:</label>
            <select id="factory-ice-type">
                <option value="‡∏´‡∏•‡∏≠‡∏î">‡∏´‡∏•‡∏≠‡∏î</option><option value="‡∏ö‡∏î‡∏´‡∏¢‡∏≤‡∏ö">‡∏ö‡∏î‡∏´‡∏¢‡∏≤‡∏ö</option><option value="‡∏ö‡∏î‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î">‡∏ö‡∏î‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</option>
            </select>
        </div>
        <div class="form-control">
            <label for="factory-quantity">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏£‡∏∞‡∏™‡∏≠‡∏ö:</label>
            <input type="number" id="factory-quantity" min="1" value="1">
        </div>
        <button onclick="recordFactorySale()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô</button>
    </div>
    
    <div class="transaction-form">
        <h2>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (‡∏£‡∏ñ‡∏≠‡∏≠‡∏Å/‡πÄ‡∏Ç‡πâ‡∏≤)</h2>
        <div class="form-control">
            <label for="truck-id">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏£‡∏ñ:</label>
            <select id="truck-id">
                <option value="1">‡∏£‡∏ñ 1</option><option value="2">‡∏£‡∏ñ 2</option><option value="3">‡∏£‡∏ñ 3</option>
                <option value="4">‡∏£‡∏ñ 4</option><option value="5">‡∏£‡∏ñ 5</option><option value="6">‡∏£‡∏ñ 6</option>
                <option value="7">‡∏£‡∏ñ 7</option><option value="8">‡∏£‡∏ñ 8</option><option value="9">‡∏£‡∏ñ 9</option>
            </select>
        </div>
        <div class="form-control">
            <label for="ice-type">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á:</label>
            <select id="ice-type">
                <option value="‡∏´‡∏•‡∏≠‡∏î">‡∏´‡∏•‡∏≠‡∏î</option><option value="‡∏ö‡∏î‡∏´‡∏¢‡∏≤‡∏ö">‡∏ö‡∏î‡∏´‡∏¢‡∏≤‡∏ö</option><option value="‡∏ö‡∏î‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î">‡∏ö‡∏î‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</option>
            </select>
        </div>
        <div class="form-control">
            <label for="quantity">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏£‡∏∞‡∏™‡∏≠‡∏ö (‡∏£‡∏ß‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏≥‡∏Å‡∏•‡∏±‡∏ö):</label>
            <input type="number" id="quantity" min="1" value="1">
        </div>
        <div class="form-control">
            <label for="action-type">‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥:</label>
            <select id="action-type" onchange="toggleSpoiledField()">
                <option value="OUT">‡∏ô‡∏≥‡∏≠‡∏≠‡∏Å (‡πÑ‡∏õ‡∏™‡πà‡∏á)</option><option value="IN">‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤ (‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏ï‡πä‡∏≠‡∏Å)</option>
            </select>
        </div>

        <div class="form-control" id="spoiled-field" style="display: none;">
            <label for="spoiled-quantity">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏£‡∏∞‡∏™‡∏≠‡∏ö‡∏ó‡∏µ‡πà **‡πÄ‡∏™‡∏µ‡∏¢/‡∏ñ‡∏π‡∏Å‡∏ï‡∏µ‡∏Å‡∏•‡∏±‡∏ö**:</label>
            <input type="number" id="spoiled-quantity" min="0" value="0">
        </div>

        <button onclick="recordTransaction()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>
    </div>

    <div class="log-area">
        <h2>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
        <div class="log-list" id="transaction-log">
            </div>
        <button onclick="exportLogToCSV()" style="background: #007bff; font-size: 16px; margin-top: 5px;">
            Export Log (‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• CSV)
        </button>
        <button onclick="clearLogHistory()" style="background: #dc3545; font-size: 16px; margin-top: 5px;">
            ‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô)
        </button>
    </div>

    <script>
        // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏ï‡πä‡∏≠‡∏Å‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
        const INITIAL_STOCK = {
            "‡∏´‡∏•‡∏≠‡∏î": 100, "‡∏ö‡∏î‡∏´‡∏¢‡∏≤‡∏ö": 50, "‡∏ö‡∏î‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î": 30
        };
        const STOCK_KEY = 'ajarnG_ice_stock';
        const LOG_KEY = 'ajarnG_ice_log';

        // ----------------------------------------------------
        // 1. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Data Handlers)
        // ----------------------------------------------------

        function getStock() {
            const stockData = localStorage.getItem(STOCK_KEY);
            return stockData ? JSON.parse(stockData) : INITIAL_STOCK;
        }

        function saveStock(stock) {
            localStorage.setItem(STOCK_KEY, JSON.stringify(stock));
        }

        function getLog() {
            const logData = localStorage.getItem(LOG_KEY);
            let log = logData ? JSON.parse(logData) : [];
            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏õ‡πÄ‡∏Å‡πà‡∏≤ (‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏¢‡∏≠‡∏∞‡∏™‡∏∏‡∏î‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô)
            return log.sort((a, b) => b.timestamp - a.timestamp); 
        }

        function addLog(newEntry) {
            const log = getLog();
            // ‡πÉ‡∏´‡πâ‡πÅ‡∏ï‡πà‡∏•‡∏∞ Log ‡∏°‡∏µ ID ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
            newEntry.id = Date.now() + Math.random().toString(16).slice(2); 
            log.push(newEntry);
            localStorage.setItem(LOG_KEY, JSON.stringify(log)); 
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ Log ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏™‡∏ï‡πä‡∏≠‡∏Å)
        function deleteLogEntry(logId) {
            if (!confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ? ‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ‡πÅ‡∏•‡∏∞‡∏à‡∏∞‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏ô‡∏∞!')) {
                return;
            }
            let log = getLog();
            const deletedEntry = log.find(entry => entry.id === logId);

            if (!deletedEntry) {
                alert('‡∏´‡∏≤‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠!');
                return;
            }

            // ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏Å‡∏•‡∏±‡∏ö‡∏Ñ‡∏∑‡∏ô‡∏î‡πâ‡∏ß‡∏¢!
            let currentStock = getStock();
            const type = deletedEntry.ice_type;
            const quantity = deletedEntry.quantity;
            const action = deletedEntry.action;

            if (action === 'OUT' || action === 'FSALE') { // FSALE ‡∏Ñ‡∏∑‡∏≠ Factory Sale
                // ‡∏ñ‡πâ‡∏≤‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ "‡∏ô‡∏≥‡∏≠‡∏≠‡∏Å" ‡∏´‡∏£‡∏∑‡∏≠ "‡∏Ç‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô" ‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏∑‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏ï‡πä‡∏≠‡∏Å
                currentStock[type] += quantity;
            } else if (action === 'IN') {
                // ‡∏ñ‡πâ‡∏≤‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ "‡∏ô‡∏≥‡∏Å‡∏•‡∏±‡∏ö (‡∏Ç‡∏≠‡∏á‡∏î‡∏µ)" ‡∏ï‡πâ‡∏≠‡∏á‡∏ô‡∏≥‡∏Ç‡∏≠‡∏á‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏™‡∏ï‡πä‡∏≠‡∏Å
                currentStock[type] -= quantity;
            } else if (action === 'ADJ') {
                // ‡∏ñ‡πâ‡∏≤‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ "‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á" ‡∏ï‡πâ‡∏≠‡∏á‡∏¢‡πâ‡∏≠‡∏ô‡∏Ñ‡πà‡∏≤‡∏Å‡∏•‡∏±‡∏ö
                currentStock[type] -= quantity;
            } else if (action === 'SPOIL') {
                // ‡∏ñ‡πâ‡∏≤‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ "‡πÄ‡∏™‡∏µ‡∏¢" ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡∏Å‡∏±‡∏ö‡∏™‡∏ï‡πä‡∏≠‡∏Å 
            }
            
            // 1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏ï‡∏¥‡∏î‡∏•‡∏ö‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô
            if (currentStock[type] < 0) {
                 alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡πÑ‡∏î‡πâ! ‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏ï‡∏¥‡∏î‡∏•‡∏ö (‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏î‡πâ‡∏ß‡∏¢ Admin ‡∏Å‡πà‡∏≠‡∏ô‡∏•‡∏ö)!');
                 return;
            }
            
            saveStock(currentStock);

            // 2. ‡∏Å‡∏£‡∏≠‡∏á Log ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠
            log = log.filter(entry => entry.id !== logId);
            localStorage.setItem(LOG_KEY, JSON.stringify(log)); 

            // 3. ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
            renderStock();
            renderLog();
            alert('‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏™‡∏ï‡πä‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß!');
        }


        // ----------------------------------------------------
        // 2. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• (Render Functions)
        // ----------------------------------------------------

        function renderStock() {
            const stock = getStock();
            const stockContainer = document.getElementById('current-stock');
            stockContainer.innerHTML = '<h2>‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (‡∏Å‡∏£‡∏∞‡∏™‡∏≠‡∏ö)</h2>'; 
            for (const type in stock) {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'stock-item';
                itemDiv.innerHTML = `<strong>${type}:</strong><span>${stock[type]} ‡∏Å‡∏£‡∏∞‡∏™‡∏≠‡∏ö</span>`;
                stockContainer.appendChild(itemDiv);
            }
        }

        function renderLog() {
            const log = getLog();
            const logContainer = document.getElementById('transaction-log');
            logContainer.innerHTML = ''; 

            let lastDate = ''; 

            log.forEach(entry => {
                const date = new Date(entry.timestamp);
                
                // 1. ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô
                const dateStr = date.toLocaleDateString('th-TH');

                if (dateStr !== lastDate) {
                    const dateHeader = document.createElement('div');
                    dateHeader.className = 'log-date-header';
                    dateHeader.innerHTML = `--- üìÖ ${dateStr} ---`;
                    logContainer.appendChild(dateHeader);
                    lastDate = dateStr;
                }
                
                // 2. ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î Log
                const timeStr = date.toLocaleTimeString('th-TH', { hour: '2-digit', minute: '2-digit', second: '2-digit' });

                let actionText;
                if (entry.action === 'OUT') {
                    actionText = `<strong style="color: red;">‡∏ô‡∏≥‡∏≠‡∏≠‡∏Å</strong>`;
                } else if (entry.action === 'IN') {
                    actionText = `<strong style="color: green;">‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤ (‡∏Ç‡∏≠‡∏á‡∏î‡∏µ)</strong>`;
                } else if (entry.action === 'ADJ') {
                    actionText = `<strong style="color: orange;">‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</strong>`;
                } else if (entry.action === 'SPOIL') {
                    actionText = `<strong style="color: purple;">‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á‡πÄ‡∏™‡∏µ‡∏¢</strong>`; 
                } else if (entry.action === 'FSALE') { // **‡πÄ‡∏û‡∏¥‡πà‡∏° Factory Sale**
                    actionText = `<strong style="color: blue;">‡∏Ç‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô</strong>`; 
                }

                const logEntry = document.createElement('div');
                logEntry.className = 'log-entry';
                
                let truckInfo;
                if (entry.truck_id === 'ADMIN') {
                    truckInfo = '[ADMIN]';
                } else if (entry.truck_id === 'FACTORY') { // **‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô ‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô**
                    truckInfo = '[‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô]';
                } else {
                    truckInfo = `‡∏£‡∏ñ ${entry.truck_id}`;
                }
                
                let entryDetails = `
                    <div style="flex-grow: 1;">
                        [${timeStr}] 
                        ${truckInfo} 
                        ${actionText} ${entry.quantity} ‡∏Å‡∏£‡∏∞‡∏™‡∏≠‡∏ö 
                        (${entry.ice_type}).
                    </div>
                    <button class="delete-btn" onclick="deleteLogEntry('${entry.id}')">‡∏•‡∏ö</button>
                `;
                
                logEntry.innerHTML = entryDetails;
                logContainer.appendChild(logEntry);
            });

            if (log.length === 0) {
                logContainer.innerHTML = '<p style="text-align: center; color: #6c757d;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß</p>';
            }
        }

        // ----------------------------------------------------
        // 7. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô: ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ä‡πà‡∏≠‡∏á‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á‡πÄ‡∏™‡∏µ‡∏¢
        // ----------------------------------------------------
        function toggleSpoiledField() {
            const action = document.getElementById('action-type').value;
            const spoiledField = document.getElementById('spoiled-field');
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤"
            if (action === 'IN') {
                spoiledField.style.display = 'block';
            } else {
                spoiledField.style.display = 'none';
                document.getElementById('spoiled-quantity').value = 0; // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡πà‡∏≤
            }
        }
        
        // ----------------------------------------------------
        // 3. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (Transaction Logic)
        // ----------------------------------------------------

        // ** ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà: ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô **
        function recordFactorySale() {
            const iceType = document.getElementById('factory-ice-type').value;
            const quantityInput = document.getElementById('factory-quantity');
            const quantity = parseInt(quantityInput.value);

            // ‡πÉ‡∏ä‡πâ‡∏ï‡∏£‡∏£‡∏Å‡∏∞‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡∏≠‡∏≠‡∏Å (OUT) ‡πÅ‡∏ï‡πà Truck ID ‡πÄ‡∏õ‡πá‡∏ô FACTORY
            if (quantity <= 0 || isNaN(quantity)) {
                alert('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏£‡∏∞‡∏™‡∏≠‡∏ö‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 0 ‡∏ô‡∏∞');
                return;
            }
            
            let currentStock = getStock();

            if (currentStock[iceType] < quantity) {
                alert(`‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á ${iceType} ‡πÑ‡∏°‡πà‡∏û‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô! ‡∏°‡∏µ‡πÅ‡∏Ñ‡πà ${currentStock[iceType]} ‡∏Å‡∏£‡∏∞‡∏™‡∏≠‡∏ö`);
                return; 
            }
            currentStock[iceType] -= quantity;
            
            // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Log ‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô
            saveStock(currentStock);
            const logEntry = {
                timestamp: Date.now(), 
                truck_id: 'FACTORY', // ‡∏ï‡∏±‡∏ß‡∏ö‡πà‡∏á‡∏ä‡∏µ‡πâ‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô
                ice_type: iceType,
                quantity: quantity,
                action: 'FSALE' // Factory Sale
            };
            addLog(logEntry);

            renderStock();
            renderLog();
            alert(`‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏ô‡∏≥‡∏≠‡∏≠‡∏Å ${quantity} ‡∏Å‡∏£‡∏∞‡∏™‡∏≠‡∏ö (${iceType})`);
            
            quantityInput.value = 1;
        }


        // ** ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏î‡∏¥‡∏°: ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤/‡∏≠‡∏≠‡∏Å **
        function recordTransaction() {
            const truckId = document.getElementById('truck-id').value;
            const iceType = document.getElementById('ice-type').value;
            const quantityInput = document.getElementById('quantity');
            const quantity = parseInt(quantityInput.value); // ‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            const action = document.getElementById('action-type').value;

            // ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏µ‡∏¢
            const spoiledQuantity = action === 'IN' ? parseInt(document.getElementById('spoiled-quantity').value) : 0;
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏à‡∏£‡∏¥‡∏á
            let actualInStock = quantity - spoiledQuantity; 

            if (quantity <= 0 || isNaN(quantity)) {
                alert('‡∏•‡∏π‡∏Å‡∏®‡∏¥‡∏©‡∏¢‡πå! ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏£‡∏∞‡∏™‡∏≠‡∏ö (‡∏£‡∏ß‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤/‡∏≠‡∏≠‡∏Å) ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 0 ‡∏ô‡∏∞');
                return;
            }
            if (spoiledQuantity < 0 || spoiledQuantity > quantity) {
                alert('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏ï‡∏¥‡∏î‡∏•‡∏ö ‡πÅ‡∏•‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏≥‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î!');
                return;
            }

            let currentStock = getStock();

            if (action === 'OUT') {
                // ‡∏ô‡∏≥‡∏≠‡∏≠‡∏Å (OUT)
                if (currentStock[iceType] < quantity) {
                    alert(`‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á ${iceType} ‡πÑ‡∏°‡πà‡∏û‡∏≠! ‡∏°‡∏µ‡πÅ‡∏Ñ‡πà ${currentStock[iceType]} ‡∏Å‡∏£‡∏∞‡∏™‡∏≠‡∏ö`);
                    return; 
                }
                currentStock[iceType] -= quantity;
                
                // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Log OUT ‡∏õ‡∏Å‡∏ï‡∏¥
                const logEntry = {
                    timestamp: Date.now(), 
                    truck_id: truckId,
                    ice_type: iceType,
                    quantity: quantity,
                    action: action
                };
                addLog(logEntry);

            } else { 
                // ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤ (IN) 
                
                // 1. ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏à‡∏£‡∏¥‡∏á (‡∏Ç‡∏≠‡∏á‡∏î‡∏µ)
                currentStock[iceType] += actualInStock;

                // 2. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Log ‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤ (‡∏Ç‡∏≠‡∏á‡∏î‡∏µ)
                if (actualInStock > 0) {
                    const goodLogEntry = {
                        timestamp: Date.now(), 
                        truck_id: truckId,
                        ice_type: iceType,
                        quantity: actualInStock,
                        action: action // IN
                    };
                    addLog(goodLogEntry);
                }

                // 3. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Log ‡∏Å‡∏≤‡∏£‡∏™‡∏π‡∏ç‡πÄ‡∏™‡∏µ‡∏¢ (‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢)
                if (spoiledQuantity > 0) {
                    const spoiledLogEntry = {
                        timestamp: Date.now() + 1, // +1ms ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡πÄ‡∏™‡∏µ‡∏¢‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏´‡∏•‡∏±‡∏á‡∏Ç‡∏≠‡∏á‡∏î‡∏µ
                        truck_id: truckId,
                        ice_type: iceType,
                        quantity: spoiledQuantity,
                        action: 'SPOIL' // SPOIL = ‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á‡πÄ‡∏™‡∏µ‡∏¢
                    };
                    addLog(spoiledLogEntry);
                }
            }

            saveStock(currentStock);
            renderStock();
            renderLog();

            let msg = `‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏£‡∏ñ ${truckId} ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤ ${quantity} ‡∏Å‡∏£‡∏∞‡∏™‡∏≠‡∏ö`;
            if (spoiledQuantity > 0) {
                msg += ` (‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏à‡∏£‡∏¥‡∏á ${actualInStock} ‡πÄ‡∏™‡∏µ‡∏¢ ${spoiledQuantity})!`;
            } else if (action === 'OUT') {
                msg = `‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏£‡∏ñ ${truckId} ‡∏ô‡∏≥‡∏≠‡∏≠‡∏Å ${quantity} ‡∏Å‡∏£‡∏∞‡∏™‡∏≠‡∏ö!`;
            }
            alert(msg);
            
            quantityInput.value = 1;
            document.getElementById('spoiled-quantity').value = 0;
            toggleSpoiledField();
        }


        // ----------------------------------------------------
        // 4. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô: ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏™‡∏ï‡πä‡∏≠‡∏Å‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á
        // ----------------------------------------------------

        function adjustStock() {
            const iceType = document.getElementById('adj-ice-type').value;
            const quantity = parseInt(document.getElementById('adj-quantity').value);

            if (isNaN(quantity) || quantity === 0) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°/‡∏•‡∏î (+/-) ‡πÄ‡∏ä‡πà‡∏ô 50 ‡∏´‡∏£‡∏∑‡∏≠ -10!');
                return;
            }

            let currentStock = getStock();
            currentStock[iceType] += quantity;

            if (currentStock[iceType] < 0) {
                alert(`‡∏™‡∏ï‡πä‡∏≠‡∏Å ${iceType} ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏¥‡∏î‡∏•‡∏ö‡πÑ‡∏î‡πâ!`);
                currentStock[iceType] -= quantity; 
                document.getElementById('adj-quantity').value = 1; 
                return;
            }

            saveStock(currentStock);

            const logEntry = {
                timestamp: Date.now(),
                truck_id: 'ADMIN',
                ice_type: iceType,
                quantity: quantity,
                action: 'ADJ', 
            };
            addLog(logEntry);

            renderStock();
            renderLog();

            alert(`‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏™‡∏ï‡πä‡∏≠‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ${iceType} ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏õ ${quantity} ‡∏Å‡∏£‡∏∞‡∏™‡∏≠‡∏ö (‡∏¢‡∏≠‡∏î‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: ${currentStock[iceType]})`);
            document.getElementById('adj-quantity').value = 1; 
        }

        // ----------------------------------------------------
        // 5. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô: ‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        // ----------------------------------------------------

        function clearLogHistory() {
            if (confirm('‡∏•‡∏π‡∏Å‡∏®‡∏¥‡∏©‡∏¢‡πå! ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏£‡∏¥‡∏á‡∏´‡∏£‡∏∑‡∏≠? ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡∏ñ‡∏≤‡∏ß‡∏£‡∏ô‡∏∞!')) {
                localStorage.removeItem(LOG_KEY);
                renderLog();
                alert('‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡∏ñ‡∏π‡∏Å‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß!');
            }
        }
        
        // ----------------------------------------------------
        // 8. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô: Export Log (‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)
        // ----------------------------------------------------
        function exportLogToCSV() {
            const log = getLog();
            if (log.length === 0) {
                alert('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å!');
                return;
            }

            let csv = 'Log_ID,Time_ms,‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà,‡πÄ‡∏ß‡∏•‡∏≤,‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏£‡∏ñ,‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á,‡∏à‡∏≥‡∏ô‡∏ß‡∏ô,‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥\n';

            log.forEach(entry => {
                const date = new Date(entry.timestamp);
                const dateStr = date.toLocaleDateString('th-TH');
                const timeStr = date.toLocaleTimeString('th-TH');
                
                csv += `${entry.id},${entry.timestamp},"${dateStr}","${timeStr}",${entry.truck_id},${entry.ice_type},${entry.quantity},${entry.action}\n`;
            });

            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            
            link.setAttribute('href', URL.createObjectURL(blob));
            link.setAttribute('download', `ice_stock_backup_${new Date().toISOString().slice(0, 10)}.csv`);

            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            alert('‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Log ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡πÄ‡∏ä‡πá‡∏Ñ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢!');
        }

        // ----------------------------------------------------
        // 6. ‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö (Initialization)
        // ----------------------------------------------------

        if (!localStorage.getItem(STOCK_KEY)) {
            saveStock(INITIAL_STOCK);
        }

        renderStock();
        renderLog();
        toggleSpoiledField(); 

    </script>
</body>
</html>
